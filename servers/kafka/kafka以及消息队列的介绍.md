### kafka定义
kafka是一个分布式的基于发布/订阅模式的消息队列（Message Queue），主要应用于大数据实时处理领域。

### 消息队列的好处
#### 1.解耦
允许你独立的扩展或修改两边的处理过程，只要确保他们遵守同样的接口约束

#### 2.可恢复性
系统的一部分组件失效时，不会影响到整个系统。消息队列降低了进程间的耦合度，所以即使一个处理消息的进程挂掉，加入队列中的消息仍然可以在系统恢复后被处理。

#### 3.缓冲
有助于控制和优化数据流经过系统的速度，解决生产消息和消费消息的处理速度不一致的情况（生产速度大于消费速度）

#### 4.灵活性和峰值处理能力
在访问量剧增的情况下，应用仍然需要继续发挥作用，但是这样的突发流量不常见。如果为以能处理这类峰值访问为标准来投入资源随时待命无疑是巨大的浪费。使用消息队列能够使关键组件顶住突发的访问压力，而不会因为突发的超负荷的请求而完全崩溃。

#### 5.异步通信
很多时候，用户不想也不需要立即处理消息。消息队列提供了异步处理机制，允许用户把一个消息放入队列，但并不立即处理它。想向队列中放入多少消息，就放多少消息，然后在需要时再去处理它们。

### 消息队列的两种模式
#### 1.点对点模式（一对一，消费者主动拉去数据，消息收到后消息清除）
消息生产者产生消息发送到Queue中，然后消息消费者从Queue中取出并且消费消息。消息被消费之后，queue中不再有存储，所以消息消费者不可能消费到已经被消费的消息。Queue支持存在多个消费者，但是对一个消息而言，只会有一个消费者可以消费。

#### 2.发布/订阅模式（一对多，消费者消费数据之后不会清除消息）
消息生产者（发布）将消息发布到topic中，同时有多个消费者（订阅）消费该消息。和点对点方式不同，发布到topic的消息会被所有订阅者消费。

发布/订阅模式又有两种区分：

##### ①生产者主动推送消息给消费者
生产者主动推送的方式的缺点是不能够知道每个消费者的消费能力如何。假如生产者恒定以50m/s的带宽推给能消费100m/s带宽的消费者A和能消费10m/s带宽的消费者B，那么会造成A资源浪费，而B崩溃。

##### ②消费者主动拉取队列中的消息。（kafka用的是这种）
消费者主动拉取的方式能很好的解决模型①中的问题。消费者按照自己的消费能力来拉去数据。但是模型②也有缺点：消费者必须轮询访问消息队列来确认是否有消息可以消费，这会有一定的请求资源浪费。
